cp /nfs/open_data/dblog/20230616/all_table/20230616/_c1\=company_patent/* /nfs/ftp/databases3/wangzhitianyuanT7/20230616/_c1\=company_patent/
cp /nfs/open_data/dblog/20230616/all_table/20230616/_c1\=company_tm/* /nfs/ftp/databases3/wangzhitianyuanT7/20230616/_c1\=company_tm/
cp /nfs/open_data/dblog/20230617/all_table/20230617/_c1\=company/* /nfs/ftp/databases3/wangzhitianyuanT7/20230617/_c1\=company/
cp /nfs/open_data/dblog/20230617/all_table/20230617/_c1\=company_patent/* /nfs/ftp/databases3/wangzhitianyuanT7/20230617/_c1\=company_patent/
cp /nfs/open_data/dblog/20230617/all_table/20230617/_c1\=company_tm/* /nfs/ftp/databases3/wangzhitianyuanT7/20230617/_c1\=company_tm/
cp /nfs/open_data/dblog/20230618/all_table/20230618/_c1\=company_tm/* /nfs/ftp/databases3/wangzhitianyuanT7/20230618/_c1\=company_tm/


cp /nfs/open_data/dblog/20230615/all_table/20230615/_c1\=company_patent/* /nfs/ftp/databases3/shiyejinfunew/20230615/_c1\=company_patent/
cp /nfs/open_data/dblog/20230616/all_table/20230616/_c1\=company_patent/* /nfs/ftp/databases3/shiyejinfunew/20230616/_c1\=company_patent/
cp /nfs/open_data/dblog/20230617/all_table/20230617/_c1\=company_patent/* /nfs/ftp/databases3/shiyejinfunew/20230617/_c1\=company_patent/
cp /nfs/open_data/dblog/20230619/all_table/20230619/_c1\=company_patent/* /nfs/ftp/databases3/shiyejinfunew/20230619/_c1\=company_patent/
cp /nfs/open_data/dblog/20230619/all_table/20230619/_c1=company_tm/*     /nfs/ftp/databases3/shiyejinfunew/20230619/_c1\=company_tm/



rm -rf /nfs/ftp/databases3/shiyejinfunew/20230615/_c1\=company_patent/*
rm -rf /nfs/ftp/databases3/shiyejinfunew/20230616/_c1\=company_patent/*
rm -rf /nfs/ftp/databases3/shiyejinfunew/20230617/_c1\=company_patent/*
rm -rf /nfs/ftp/databases3/shiyejinfunew/20230619/_c1\=company_patent/*Moka20190520
rm -rf /nfs/ftp/databases3/shiyejinfunew/20230619/_c1\=company_tm/*



dwt_open_data_union_di -> dwt_open_data_all_di -> dwt_open_data_all_to_nfs_di


ll /nfs/ftp/databases3 


CREATE CATALOG catalog_company_base PROPERTIES (
    "type"="jdbc",
    "user"="jdhw_d_data_dml",
    "password"="2s0^tFa4SLrp72",
    "jdbc_url" = "jdbc:mysql://ee59dd05fc0f4bb9a2497c8d9146a53cin01.internal.cn-north-4.mysql.rds.myhuaweicloud.com:3306/company_base",
    "driver_url" = "file:///home/work/mysql-connector-java-5.1.48.jar",
    "driver_class" = "com.mysql.jdbc.Driver",
    "only_specified_database"="true"
);


CREATE CATALOG catalog_shareholder PROPERTIES (
    "type"="jdbc",
    "user"="jdhw_d_data_dml",
    "password"="2s0^tFa4SLrp72",
    "jdbc_url" = "jdbc:mysql://e1d4c0a1d8d1456ba4b461ab8b9f293din01.internal.cn-north-4.mysql.rds.myhuaweicloud.com:3306/prism_shareholder_path",
    "driver_url" = "file:///home/work/mysql-connector-java-5.1.48.jar",
    "driver_class" = "com.mysql.jdbc.Driver",
    "only_specified_database"="true"
);

explain
select t1.id,t2.id from catalog_shareholder.prism_shareholder_path.ratio_path_company t1 join catalog_company_base.company_base.company_index t2
on t1.company_id = t2.company_id where t1.id = 777;


explain
with t1 as(
  select company_id from catalog_shareholder.prism_shareholder_path.ratio_path_company where id = 777
),t2 as(
  select id from catalog_company_base.company_base.company_index where company_id in (select company_id from t1)
)select * from t2;


with t1 as(
  select company_id from catalog_t1 where id in (555,666,777)
)
select company_name from catalog_t2 where company_id in (select company_id from t1)




create view view1 as select company_id from catalog_shareholder.prism_shareholder_path.ratio_path_company where id = 777;
explain
select company_name
from catalog_company_base.company_base.company_index
where company_id in (select 3092239560);


select company_name from catalog_company_base.company_base.company_index where company_id in (select 1)
