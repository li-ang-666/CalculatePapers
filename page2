drop table ads_user_tag_commercial_df_tmp force;
CREATE TABLE `ads_user_tag_commercial_df_tmp`(                           
  `tyc_user_id` bigint COMMENT '天眼查用户id',                           
  `mobile` string COMMENT '用户手机号-未加密',                           
  `user_state` string COMMENT '用户状态（全量）',                        
  `paypoint_show_30day` int COMMENT '近30日触发痒点次数',                
  `is_unpay_180day` int COMMENT '近180日VIP未付订单订单数',              
  `is_discount_last` string COMMENT '上一笔是否为优惠订单',              
  `vip_order_sku_last` string COMMENT '上一笔VIP订单的购买期限',         
  `vip_overdue_day` int COMMENT 'VIP过期天数',                           
  `vip_expiration_day` int COMMENT 'VIP剩余权益天数',                    
  `active_days_30day` int COMMENT '近30日活跃天数',                      
  `active_days_90day` int COMMENT '近90日活跃天数',                      
  `active_days_365day` int COMMENT '近365日活跃天数',                    
  `svip_paypoint_show_pv_30day` int COMMENT '近30日触发红钻/SVIP痒点次数',
  `svip_paypoint_show_pv_7day` int COMMENT '近7日触发红钻/SVIP痒点次数', 
  `vip_paypoint_show_pv_7day` int COMMENT '近7日触发VIP痒点次数',        
  `svip_unpay_order_cnt_30day` int COMMENT '近30日SVIP未付订单数',       
  `is_boss_user` string COMMENT '是否老板用户',                          
  `is_stuff_user` string COMMENT '是否内部员工用户',                     
  `is_test_user` string COMMENT '是否测试黑名单用户',                    
  `is_vvip_media_user` string COMMENT '是否VVIP与媒体用户',              
  `is_ga_user` string COMMENT '是否政府用户',                            
  `svip_expiration_day` int COMMENT '有效SVIP权益剩余天数',              
  `red_expiration_day` int COMMENT '有效红钻权益剩余天数',               
  `svip_overdue_day` int COMMENT '失效SVIP过期天数',                     
  `red_overdue_day` int COMMENT '失效/红钻过期天数',                     
  `regist_days` int COMMENT '注册天数',                                  
  `paypoint_show_60day` int COMMENT '近60日触发痒点次数',                
  `is_unpay_1day` int COMMENT '近1日VIP未付订单订单数',                  
  `is_unpay_15day` int COMMENT '近15日VIP未付订单订单数',                
  `is_unpay_90day` int COMMENT '近90日VIP未付订单订单数',                
  `svip_unpay_order_cnt_180day` int COMMENT '近180日SVIP未付订单数',     
  `active_days_by_month` int COMMENT '当月活跃天数',                     
  `last_vip_order_goods_type` string COMMENT '上一笔VIP订单类型',        
  `svip_unpay_order_cnt_7day` int COMMENT '近7日SVIP未付订单数',         
  `vip_paypoint_show_pv_14day` int COMMENT '近14日触发VIP痒点次数',      
  `vip_paypoint_show_pv_30day` int COMMENT '近30日触发VIP痒点次数',      
  `tyc_user_id_last_number` string COMMENT '用户id尾号')ENGINE=OLAP
UNIQUE KEY(`tyc_user_id`)
DISTRIBUTED BY HASH(`tyc_user_id`) BUCKETS auto
PROPERTIES (
  "function_column.sequence_type" = 'largeint',
  "replication_allocation" = "tag.location.default: 3"
  -- "enable_unique_key_merge_on_write" = "true"
);
