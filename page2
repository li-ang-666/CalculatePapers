WITH m_1_0 AS (
SELECT x0 AS x0,x1 AS x1,x2 AS x2,x3 AS x3,x4 AS x4,x5 AS x5,x6 AS x6,x7 AS x7,x8 AS x8,x9 AS x9,seq_x0 AS seq_x0,s0 AS s0,s1 AS s1,s2 AS s2,s3 AS s3,m0 AS m0,m1 AS m1,m2 AS m2,(c0_0_a0_e2) AS c0,(c1_0_a0_e2_a0_e20)/(c1_2_a6_e8_a0_e26) AS c1,(c2_0_a0_e2_a0_e20)/(c2_2_a6_e8_a0_e20) AS c2 FROM (
SELECT x0 AS x0,x1 AS x1,x2 AS x2,x3 AS x3,x4 AS x4,x5 AS x5,x6 AS x6,x7 AS x7,x8 AS x8,x9 AS x9,seq_x0 AS seq_x0,sum(c0_0_a0_e2) AS c0_0_a0_e2,sum(c1_0_a0_e2_a0_e20) AS c1_0_a0_e2_a0_e20,sum(c1_2_a6_e8_a0_e26) AS c1_2_a6_e8_a0_e26,sum(c2_2_a6_e8_a0_e20) AS c2_2_a6_e8_a0_e20,sum(c2_0_a0_e2_a0_e20) AS c2_0_a0_e2_a0_e20,sum(s0) AS s0,sum(s1) AS s1,sum(s2) AS s2,sum(s3) AS s3,sum(m0) AS m0,sum(m1) AS m1,sum(m2) AS m2 FROM ((
SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,count(DISTINCT (t_2_0.`id`))+count(DISTINCT (t_6_0.`id`)) AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,0 AS s0,0 AS s1,0 AS s2,0 AS s3,0 AS m0,0 AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_candidates AS t_6_0 ON (t_2_0.`candidate_id`=t_6_0.`id`) AND (t_6_0.`deleted`='0' AND t_6_0.`org_id`='officialqa') LEFT JOIN dwd_candidate_recruit_status AS t_6_5 ON (t_6_0.`id`=t_6_5.`candidate_id`) AND (t_6_5.`org_id`='officialqa') LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (((t_2_0.`added_by` IN ('410079097','410096233'))) AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1)) AND (t_6_5.`is_social`='1' OR t_6_5.`is_social` IS NULL)) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
--SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,count(DISTINCT (t_2_0.`id`)) AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,0 AS s0,0 AS s1,0 AS s2,0 AS s3,0 AS m0,0 AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (((t_2_0.`added_by` IN ('410079097','410096233'))) AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1))) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
--SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,count(DISTINCT (DATE_FORMAT(t_4_0.`next_entered_at`,"%d日"))) AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,0 AS s0,0 AS s1,0 AS s2,0 AS s3,0 AS m0,0 AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_application_stage_states AS t_4_0 ON (t_2_0.`id`=t_4_0.`application_id`) AND (t_4_0.`deleted`='0' AND t_4_0.`entered_at` IS NOT NULL AND t_4_0.`org_id`='officialqa' AND t_4_0.`hire_mode` IN (1)) LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (((t_2_0.`added_by` IN ('410079097','410096233'))) AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1))) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
--SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,count(DISTINCT (t_4_0.`application_id`)) AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,0 AS s0,0 AS s1,0 AS s2,0 AS s3,0 AS m0,0 AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_application_stage_states AS t_4_0 ON (t_2_0.`id`=t_4_0.`application_id`) AND (t_4_0.`deleted`='0' AND t_4_0.`entered_at` IS NOT NULL AND t_4_0.`org_id`='officialqa' AND t_4_0.`hire_mode` IN (1)) LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (((t_2_0.`added_by` IN ('410079097','410096233'))) AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1))) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
--SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,count(DISTINCT (t_2_0.`id`)) AS c2_0_a0_e2_a0_e20,0 AS s0,0 AS s1,0 AS s2,0 AS s3,0 AS m0,0 AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE ((t_2_0.`is_hired` IN ('1')) AND ((t_2_0.`added_by` IN ('410079097','410096233'))) AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1))) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
--SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,count(DISTINCT (t_2_0.`id`))+count(DISTINCT (t_6_0.`id`)) AS s0,0 AS s1,0 AS s2,0 AS s3,0 AS m0,0 AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_candidates AS t_6_0 ON (t_2_0.`candidate_id`=t_6_0.`id`) AND (t_6_0.`deleted`='0' AND t_6_0.`org_id`='officialqa') LEFT JOIN dwd_candidate_recruit_status AS t_6_5 ON (t_6_0.`id`=t_6_5.`candidate_id`) AND (t_6_5.`org_id`='officialqa') LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (t_2_0.`added_by` IN ('410079097','410096233') AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1)) AND (t_6_5.`is_social`='1' OR t_6_5.`is_social` IS NULL)) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
--SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,0 AS s0,count(DISTINCT (t_7_0.`id`)) AS s1,0 AS s2,0 AS s3,0 AS m0,0 AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_interviews AS t_7_0 ON (t_2_0.`id`=t_7_0.`application_id`) AND (t_7_0.`deleted`='0' AND t_7_0.`org_id`='officialqa' AND t_7_0.`hire_mode` IN (1)) LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (t_2_0.`added_by` IN ('410079097','410096233') AND (t_7_0.`is_signed_in`='1') AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1))) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
--SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,0 AS s0,0 AS s1,count(DISTINCT (t_4_0.`application_id`)) AS s2,0 AS s3,0 AS m0,0 AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_application_stage_states AS t_4_0 ON (t_2_0.`id`=t_4_0.`application_id`) AND (t_4_0.`deleted`='0' AND t_4_0.`entered_at` IS NOT NULL AND t_4_0.`org_id`='officialqa' AND t_4_0.`hire_mode` IN (1)) LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (t_2_0.`added_by` IN ('410079097','410096233') AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1))) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
--SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,0 AS s0,0 AS s1,0 AS s2,avg(timestampdiff(HOUR,t_2_0.`applied_at`,IF (t_2_0.`offer_sent_at`< t_2_0.`applied_at` AND LEFT (t_2_0.`applied_at`,10)=LEFT (t_2_0.`offer_sent_at`,10),t_2_0.`applied_at`,t_2_0.`offer_sent_at`))) AS s3,0 AS m0,0 AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (t_2_0.`added_by` IN ('410079097','410096233') AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1))) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
--SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,0 AS s0,0 AS s1,0 AS s2,0 AS s3,sum(YEAR (now())-t_6_0.`birth_year`) AS m0,0 AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_candidates AS t_6_0 ON (t_2_0.`candidate_id`=t_6_0.`id`) AND (t_6_0.`deleted`='0' AND t_6_0.`org_id`='officialqa') LEFT JOIN dwd_candidate_recruit_status AS t_6_5 ON (t_6_0.`id`=t_6_5.`candidate_id`) AND (t_6_5.`org_id`='officialqa') LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (t_2_0.`added_by` IN ('410079097','410096233') AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1)) AND (t_6_5.`is_social`='1' OR t_6_5.`is_social` IS NULL)) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
--SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,0 AS s0,0 AS s1,0 AS s2,0 AS s3,0 AS m0,count(DISTINCT (t_42_0.`depart_level_2`)) AS m1,0 AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (t_2_0.`added_by` IN ('410079097','410096233') AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1))) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) UNION ALL (
SELECT t_2_0.`current_stage_id` AS x0,t_2_0.`first_channel` AS x1,DATE_FORMAT(t_2_0.`applied_at`,'%Y-%m-%d') AS x2,DATE_FORMAT(t_2_0.`applied_at`,"%Y年") AS x3,CONCAT("Q",QUARTER (t_2_0.`applied_at`)) AS x4,DATE_FORMAT(t_2_0.`applied_at`,"%m月") AS x5,DATE_FORMAT(t_2_0.`applied_at`,"W%v") AS x6,DATE_FORMAT(t_2_0.`applied_at`,"%d日") AS x7,t_2_0.`added_by` AS x8,t_42_0.`depart_level_1` AS x9,t_2_6.`seq` AS seq_x0,0 AS c0_0_a0_e2,0 AS c1_0_a0_e2_a0_e20,0 AS c1_2_a6_e8_a0_e26,0 AS c2_2_a6_e8_a0_e20,0 AS c2_0_a0_e2_a0_e20,0 AS s0,0 AS s1,0 AS s2,0 AS s3,0 AS m0,0 AS m1,sum(timestampdiff(DAY,t_2_0.`applied_at`,IF (t_2_0.`hired_at`< t_2_0.`applied_at` AND LEFT (t_2_0.`applied_at`,10)=LEFT (t_2_0.`hired_at`,10),t_2_0.`applied_at`,t_2_0.`hired_at`))) AS m2 FROM dwd_applications AS t_2_0 LEFT JOIN dwd_pipeline_stage AS t_2_6 ON (t_2_0.`current_stage_id`=t_2_6.`stage_id`) AND (t_2_6.`pipeline_id`='0' AND t_2_6.`org_id`='officialqa') LEFT JOIN dwd_offers AS t_8_0 ON (t_2_0.`id`=t_8_0.`application_id`) AND (t_8_0.`deleted`='0' AND t_8_0.`org_id`='officialqa' AND t_8_0.`hire_mode` IN (1)) LEFT JOIN dwd_departments AS t_42_0 ON (t_8_0.`hcm_department_id`=t_42_0.`id`) AND (t_42_0.`org_id`='officialqa') WHERE (t_2_0.`added_by` IN ('410079097','410096233') AND (t_2_0.`deleted`='0' AND t_2_0.`org_id`='officialqa' AND t_2_0.`hire_mode` IN (1))) GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0)) AS union_table GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0) AS final_table GROUP BY x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,seq_x0,s0,s1,s2,s3,m0,m1,m2,c0,c1,c2) 
select * from m_1_0 where m_1_0.`x8` IN ('410079097','410096233') limit 11;



with m_1_0 as(
select added_by x8 from dwd_applications where org_id = 'not exists'
)
select * from m_1_0 where m_1_0.`x8` IN ('410079097','410096233') limit 11;



